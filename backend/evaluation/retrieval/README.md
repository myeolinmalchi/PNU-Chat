# Retrieval Strategy Evaluation

## Description

- ë‹¤ì–‘í•œ Retrieval ì „ëµ(Dense-only, Hybrid ë“±)ì— ëŒ€í•´ Recall ì„±ëŠ¥ì„ ë¹„êµ í‰ê°€í•©ë‹ˆë‹¤.
- íŠ¹íˆ ì €ì‚¬ì–‘ CPU í™˜ê²½(Q8 ëª¨ë¸)ì—ì„œ í’ˆì§ˆ ì €í•˜ë¥¼ ìµœì†Œí™”í•˜ëŠ” ì „ëµ íƒìƒ‰ì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤.

## Environment

- Text Embedding: `BAAI/bge-m3`
- Reranker: `BAAI/bge-reranker-v2-m3`
- Quantization:
  - FP32 (Full Precision, ONNX)
  - Q8 (8-bit Quantized, GGUF)
- Augmentation: `solar-pro`

## Dataset Augmentation

### ì¦ê°• ë° ê²€ì¦ íŒŒì´í”„ë¼ì¸
1. Query ìƒì„± (Augmentor)
  - LLMì„ ê¸°ë°˜ìœ¼ë¡œ ê° ë¬¸ì„œ ë³¸ë¬¸ê³¼ ê´€ë ¨ëœ ì§ˆë¬¸(Query) 5ê°œë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
  - ì§ˆë¬¸ê³¼ í‘œí˜„ì€ ë‹¤ë¥´ì§€ë§Œ ë™ì¼í•œ ì˜ë¯¸ë¥¼ ê°–ëŠ” Paraphraseë¥¼ 1ê°œì”© ì¶”ê°€ ìƒì„±í•©ë‹ˆë‹¤.
  - ê° ë¬¸ì„œë§ˆë‹¤ ì´ 10ê°œì˜ ì§ˆì˜(5 Queries + 5 Paraphrases)ê°€ ìƒì„±ë©ë‹ˆë‹¤.
2. Query ê²€ì¦ (Validator)
  - ìƒì„±ëœ ê° Queryê°€ ì•„ë˜ ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ”ì§€ LLMì„ í†µí•´ ê²€ì¦í•©ë‹ˆë‹¤.
  - ì¡°ê±´ì„ ë§Œì¡±í•˜ì§€ ëª»í•  ê²½ìš°, ì‚¬ìœ (`reasons`)ë¥¼ ê¸°ë¡í•˜ê³  ì§ˆì˜ë¥¼ ì¬ìƒì„±í•©ë‹ˆë‹¤.
3. ìµœì¢… ë°ì´í„° ì €ì¥
  - ëª¨ë“  ì§ˆì˜ê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ë©´, ê° ë¬¸ì„œì˜ URLê³¼ ê´€ë ¨ ì§ˆì˜ ëª©ë¡ì„ JSONL í¬ë§·ìœ¼ë¡œ ì €ì¥í•©ë‹ˆë‹¤.

### ì¶œë ¥ ì˜ˆì‹œ
```json
{
  "url": "https://onestop.pusan.ac.kr/page?menuCD=000000000000282",
  "queries": [
    "ì¡¸ì—… ìœ ì˜ˆëŠ” ëª‡ë²ˆê¹Œì§€ í•  ìˆ˜ ìˆë‚˜ìš”?",
    "í•™ì‚¬í•™ìœ„ì·¨ë“ìœ ì˜ˆëŠ” ìµœëŒ€ ëª‡ íšŒ ê°€ëŠ¥í•œê°€ìš”?",
    "ì¼ë°˜íœ´í•™ ì¤‘ ì…ëŒ€í•˜ëŠ” ê²½ìš° íœ´í•™ì„ ë³‘ì—­íœ´í•™ìœ¼ë¡œ ì „í™˜í•˜ëŠ” ë°©ë²•ì€ ë¬´ì—‡ì¸ê°€ìš”?",
    "í•™ìƒì§€ì›ì‹œìŠ¤í…œì—ì„œ ì¼ë°˜íœ´í•™ê³¼ ë³‘ì—­íœ´í•™ì„ ì‹ ì²­í•˜ëŠ” ë°©ë²•ì€ ë¬´ì—‡ì¸ê°€ìš”?"
  ]
}
```

## Evaluation Results

### í•™ìƒì§€ì›ì‹œìŠ¤í…œ

- Total Documents: 120
- Total Queries: 870 (10/doc)

#### Strategies

| ver | Strategy | Description |
|---:|:---|:---|
| V1 | Dense-only | ë³¸ë¬¸ Semantic Search |
| V2 | Hybrid (Dense + Sparse) | ë³¸ë¬¸ Lexical + Semantic Score ê°€ì¤‘í•© |
| V3 | Hybrid + RRF | ë³¸ë¬¸ ë° ìš”ì•½ Hybrid Score + RRF |
| V4 | ğŸš§ V3 + Reranker | Top-10 Retrieval ê²°ê³¼ Rerank |

#### Results

![output (5)](https://github.com/user-attachments/assets/03be36ac-cb66-4945-be9d-bed233232d2a)

  
| ver | rrf k | $w_{lex}$ | Recall@3<br>(FP32) | Recall@3<br>(Q8) |
|:---:|---:|---:|---:|---:|
| V1 | - | - | 76.90 | 62.30 |
| V2 | - | 0.3 | ğŸ¥‡78.74 | 69.54 |
| V2 | - | 0.5 | 77.36 | 70.57 |
| V2 | - | 0.7 | 74.25 | 68.05 |
| V3 | 40 | 0.3 | 77.36 | 68.85 |
| V3 | 40 | 0.5 | ğŸ¥ˆ78.51 | 74.02 |
| V3 | 40 | 0.7 | 77.01 | 76.09 |
| V3 | 20 | 0.7 | 77.36 | ğŸ¥ˆ77.13 |
| V3 | 10 | 0.7 | 77.82 | ğŸ¥‡77.82 |
| V4 | 40 | 0.5 | ğŸš§37.93 | - |
